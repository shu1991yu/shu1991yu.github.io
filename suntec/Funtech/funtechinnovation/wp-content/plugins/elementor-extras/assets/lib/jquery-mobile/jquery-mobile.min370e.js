!function(t,e,n){"function"==typeof define&&define.amd?define(["jquery"],function(a){return n(a,t,e),a.mobile}):n(t.jQuery,t,e)}(this,document,function(t,e,n,a){!function(e){"function"==typeof define&&define.amd?define("vmouse",["jquery"],e):e(t)}(function(t){function e(t){for(;t&&void 0!==t.originalEvent;)t=t.originalEvent;return t}function o(n,o){var i,u,r,c,s,h,d,l,f,v=n.type;if(n=t.Event(n),n.type=o,i=n.originalEvent,u=E,v.search(/^(mouse|click)/)>-1&&(u=I),i)for(d=u.length;d;)c=u[--d],n[c]=i[c];if(v.search(/mouse(down|up)|click/)>-1&&!n.which&&(n.which=1),-1!==v.search(/^touch/)&&(r=e(i),v=r.touches,s=r.changedTouches,h=v&&v.length?v[0]:s&&s.length?s[0]:a))for(l=0,f=X.length;l<f;l++)c=X[l],n[c]=h[c];return n}function i(e){for(var n,a,o={};e;){n=t.data(e,w);for(a in n)n[a]&&(o[a]=o.hasVirtualBinding=!0);e=e.parentNode}return o}function u(e,n){for(var a;e;){if((a=t.data(e,w))&&(!n||a[n]))return e;e=e.parentNode}return null}function r(){H=!1}function c(){H=!0}function s(){z=0,S.length=0,q=!1,c()}function h(){r()}function d(){x&&(clearTimeout(x),x=0)}function l(){d(),x=setTimeout(function(){x=0,s()},t.vmouse.resetTimerDuration)}function f(e,n,a){var i;return(a&&a[e]||!a&&u(n.target,e))&&(i=o(n,e),t(n.target).trigger(i)),i}function v(e){var n,a=t.data(e.target,P);"click"===e.type&&"touchstart"===t.data(e.target,"lastTouchType")&&setTimeout(function(){"touchstart"===t.data(e.target,"lastTouchType")&&(s(),delete t.data(e.target).lastTouchType,v(e))},t.vmouse.maximumTimeBetweenTouches),q||z&&z===a||(n=f("v"+e.type,e))&&(n.isDefaultPrevented()&&e.preventDefault(),n.isPropagationStopped()&&e.stopPropagation(),n.isImmediatePropagationStopped()&&e.stopImmediatePropagation())}function m(n){var a,o,u,r=e(n).touches;r&&1===r.length&&(a=n.target,o=i(a),t.data(n.target,"lastTouchType",n.type),o.hasVirtualBinding&&(z=Q++,t.data(a,P,z),d(),h(),N=!1,u=e(n).touches[0],K=u.pageX,j=u.pageY,f("vmouseover",n,o),f("vmousedown",n,o)))}function p(e){H||(N||f("vmousecancel",e,i(e.target)),t.data(e.target,"lastTouchType",e.type),N=!0,l())}function g(n){if(!H){var a=e(n).touches[0],o=N,u=t.vmouse.moveDistanceThreshold,r=i(n.target);t.data(n.target,"lastTouchType",n.type),N=N||Math.abs(a.pageX-K)>u||Math.abs(a.pageY-j)>u,N&&!o&&f("vmousecancel",n,r),f("vmousemove",n,r),l()}}function T(n){if(!H&&t.data(n.target,"lastTouchType")!==a){c(),delete t.data(n.target).lastTouchType;var o,u,r=i(n.target);f("vmouseup",n,r),N||(o=f("vclick",n,r))&&o.isDefaultPrevented()&&(u=e(n).changedTouches[0],S.push({touchID:z,x:u.clientX,y:u.clientY}),q=!0),f("vmouseout",n,r),N=!1,l()}}function y(e){var n,a=t.data(e,w);if(a)for(n in a)if(a[n])return!0;return!1}function b(){}var D,k,w="virtualMouseBindings",P="virtualTouchID",X="clientX clientY pageX pageY screenX screenY".split(" "),Y="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),E="altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),B=t.event.mouseHooks?t.event.mouseHooks.props:[],I=E.concat(B),M={},x=0,K=0,j=0,N=!1,S=[],q=!1,H=!1,L="addEventListener"in n,V=t(n),Q=1,z=0;for(t.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500,maximumTimeBetweenTouches:100},k=0;k<Y.length;k++)t.event.special[Y[k]]=function(e){var n=e.substr(1);return{setup:function(){y(this)||t.data(this,w,{}),t.data(this,w)[e]=!0,M[e]=(M[e]||0)+1,1===M[e]&&V.bind(n,v),t(this).bind(n,b),L&&(M.touchstart=(M.touchstart||0)+1,1===M.touchstart&&V.bind("touchstart",m).bind("touchend",T).bind("touchmove",g).bind("scroll",p))},teardown:function(){--M[e],M[e]||V.unbind(n,v),L&&(--M.touchstart||V.unbind("touchstart",m).unbind("touchmove",g).unbind("touchend",T).unbind("scroll",p));var a=t(this),o=t.data(this,w);o&&(o[e]=!1),a.unbind(n,b),y(this)||a.removeData(w)}}}(Y[k]);L&&n.addEventListener("click",function(e){var n,a,o,i,u,r=S.length,c=e.target;if(r)for(n=e.clientX,a=e.clientY,D=t.vmouse.clickDistanceThreshold,o=c;o;){for(i=0;i<r;i++)if(u=S[i],0,o===c&&Math.abs(u.x-n)<D&&Math.abs(u.y-a)<D||t.data(o,P)===u.touchID)return e.preventDefault(),void e.stopPropagation();o=o.parentNode}},!0)})});